import{h as p,ae as F,au as o,r as f,j as t,H as E,B as n,a as c,ao as B,bb as I,M as v,F as k,bc as w,be as D}from"./index.5f43b6ab.js";import{T as y}from"./index.1675b94f.js";import{C}from"./index.084ff5a4.js";import{P as L}from"./index.a7c29097.js";import{i as S,C as T,D as q}from"./use-immer.module.abcd53e3.js";import{c as O}from"./convertNullToUndefined.a19d8223.js";import{M as _}from"./index.4c803d66.js";import{t as A}from"./index.49afe081.js";import{I as P}from"./index.23250b48.js";import{I as M}from"./index.71a3279f.js";import"./index.4f7c900b.js";import"./index.e6b53453.js";import"./index.fa98d016.js";import"./index.7c1755be.js";function W(e){return p.post("/api/page/query",e)}function j(e){return p.post("/api/page/detail",e)}function z(e){return p.post("/api/page/create",e)}function H(e){return p.post("/api/page/update",e)}function N(e){return p.post("/api/page/delete",e)}function R(e){return p.post("/api/page/enable",{uuid:e})}function U(e){return p.post("/api/page/disable",{uuid:e})}const b=F.TextArea;function V(e){const[s]=o.useForm(),[g,l]=f.exports.useState(!1);async function m(){s.validate().then(async r=>{l(!0);try{const u={...r,status:r.status?"true":"false"};let h;e.data?h=await H({...u,uuid:e.data.uuid||e.uuid}):h=await z(u),h.code===0&&(e.reload(),e.close())}finally{l(!1)}}).catch(r=>{if(r.errors)for(const u in r.errors)v.error(r.errors[u].message)})}return f.exports.useEffect(()=>{var r;if((r=e.data)!=null&&r.page){const u=O(e.data.page);s.setFieldsValue({...u})}},[e.data]),f.exports.useEffect(()=>{e.visible===!1&&s.resetFields()},[s,e.visible]),t(C,{title:e.data?"\u4FEE\u6539\u5355\u9875":"\u521B\u5EFA\u5355\u9875",extra:t(E,{style:{cursor:"point",color:"#333",fontSize:"16px"},onClick:()=>e.close()}),actions:[t(n,{type:"default",onClick:()=>e.close(),children:"\u53D6\u6D88"},"cancel"),t(n,{type:"primary",loading:g,onClick:m,children:e.data?"\u4FDD\u5B58":"\u521B\u5EFA"},"submit")],children:c(o,{form:s,labelCol:{span:2},wrapperCol:{span:22},children:[t(o.Item,{label:"\u6807\u9898",field:"title",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898"}],children:t(F,{maxLength:100,showWordLimit:!0,placeholder:"\u8BF7\u8F93\u5165\u6807\u9898"})}),t(o.Item,{label:"\u7F16\u7801",field:"code",wrapperCol:{span:2},children:t(F,{maxLength:50,placeholder:"\u8BF7\u8F93\u5165\u7F16\u7801"})}),t(o.Item,{label:"SEO\u6807\u9898",field:"seo_title",children:t(F,{maxLength:200,showWordLimit:!0,placeholder:"SEO\u6807\u9898"})}),t(o.Item,{label:"SEO\u63CF\u8FF0",field:"seo_desc",children:t(b,{maxLength:200,placeholder:"SEO\u63CF\u8FF0",showWordLimit:!0,autoSize:!0,style:{minHeight:64}})}),t(o.Item,{label:"SEO\u5173\u952E\u8BCD",field:"seo_keywords",children:t(b,{maxLength:200,placeholder:"SEO\u5173\u952E\u8BCD",showWordLimit:!0,autoSize:!0,style:{minHeight:64}})}),t(o.Item,{label:"\u542F\u7528",field:"status",triggerPropName:"checked",initialValue:!1,children:t(B,{})}),t(I,{orientation:"left",children:"\u6B63\u6587"}),t(o.Item,{field:"content",wrapperCol:{span:24},triggerPropName:"html",trigger:"getContent",rules:[{required:!0},{validator(r,u){if(r==="<p><br></p>")return u("\u8BF7\u8F93\u5165\u6B63\u6587");u()}}],children:t(_,{})})]})})}function oe(){const e=f.exports.useRef(),[s,g]=f.exports.useState([]),[l,m]=S({visible:!1,close:function(){m(i=>{i.visible=!1})}}),[r,u]=f.exports.useState();async function h(i){try{const a=await j({uuid:i});a.code===0&&(u(i),m(d=>{d.data=a.data,d.visible=!0}))}catch{}}f.exports.useEffect(()=>{A().then(i=>{const a=[];for(const d in i.data)a.push({value:d,label:i.data[d]});g(a)})},[]);const x=[{title:"\u5173\u952E\u8BCD",dataIndex:"keyword",search:!0,hide:!0},{title:"\u6807\u9898",dataIndex:"title",ellipsis:!0},{title:"\u7F16\u7801",dataIndex:"code"},{title:"\u542F\u7528\u72B6\u6001",dataIndex:"status",render(i,a){return a.status===1?t(y,{color:"green",children:"\u542F\u7528"}):t(y,{color:"red",children:"\u7981\u7528"})}},{title:"\u4FEE\u6539\u65F6\u95F4",dataIndex:"updated_at"},{title:"\u64CD\u4F5C",width:280,render:(i,a)=>c(T,{children:[c(n,{type:"text",onClick:()=>h(a.uuid),children:[t(w,{}),"\u7F16\u8F91"]}),a.status===0?c(n,{type:"text",onClick:async()=>{(await R(a.uuid)).code===0&&e.current.reload()},children:[t(P,{}),"\u542F\u7528"]}):c(n,{type:"text",onClick:async()=>{(await U(a.uuid)).code===0&&e.current.reload()},children:[t(D,{}),"\u7981\u7528"]}),t(q,{reqDel:N,params:{uuid:a.uuid},reload:()=>e.current.reload(),children:c(n,{type:"text",children:[t(M,{}),"\u5220\u9664"]})})]})}];return c(k,{children:[l.visible&&t(V,{visible:l.visible,data:l.data,close:()=>l.close(),reload:()=>e.current.reload(),target:s,uuid:r}),t(C,{style:{display:l.visible?"none":void 0},children:t(L,{ref:e,request:W,columns:x,actionBarRender:[t(n,{type:"primary",onClick:()=>e.current.reload(),children:"\u5237\u65B0"},"refresh")],toolBarRender:[t(n,{type:"primary",onClick:()=>{u(void 0),m(i=>{i.visible=!0,i.data=void 0})},children:"\u521B\u5EFA\u5355\u9875"},"create")]})})]})}export{oe as default};
