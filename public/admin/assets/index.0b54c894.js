import{e as I,r as C,a7 as O,j as a,a8 as B,am as b,aB as F,a as p,a6 as g,aE as j,ao as E,ap as P,B as v,aF as S}from"./index.ef2d81d5.js";import{C as k}from"./index.fbbfb972.js";import{P as q}from"./index.5c6aa921.js";import{r as _,j as A,i as x,c as M,k as N,C as R,D as V,I as G}from"./DelPopconfirm.713e04c5.js";function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,l)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D(Object(r),!0).forEach(function(l){B(e,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(r,l))})}return e}function L(e,t){var r=C.exports.useContext(O),l=r.prefixCls,s=l===void 0?"arco":l,d=e.spin,c=e.className,o=w(w({"aria-hidden":!0,focusable:!1,ref:t},e),{},{className:"".concat(c?c+" ":"").concat(s,"-icon ").concat(s,"-icon-subscribe-add")});return d&&(o.className="".concat(o.className," ").concat(s,"-icon-loading")),delete o.spin,delete o.isIcon,a("svg",{fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48",...o,children:a("path",{d:"M24.53 6.007H9.97c-.535 0-.97.449-.97 1.003V41.8c0 .148.152.245.28.179l15.25-7.881 14.248 7.88c.129.067.28-.03.28-.179V22.06M27.413 11.023h6.794m0 0H41m-6.794 0V4m0 7.023v7.023"})})}var m=I.forwardRef(L);m.defaultProps={isIcon:!0};m.displayName="IconSubscribeAdd";var H=m;const{Row:$,Col:h}=E;function z(e){const[t]=b.useForm(),[r,l]=C.exports.useState(!1);C.exports.useEffect(()=>{e.data&&t.setFieldsValue(e.data),e.visible||t.resetFields()},[t,e.data,e.visible]);async function s(){t.validate().then(async d=>{var o;l(!0);let c;e.uuid?c=await _({...d,uuid:e.uuid}):c=await A({...d,pid:(o=e.id)!=null?o:0,level:e.level?e.level+1:1}),c.code===0&&(P.success(c.message),e.reload(),e.close(),t.resetFields())}).catch(d=>{console.log(d)}).finally(()=>{l(!1)})}return a(F,{width:400,title:e.uuid?"\u66F4\u65B0\u5206\u7C7B":"\u521B\u5EFA\u5206\u7C7B",visible:e.visible,onOk:s,onCancel:e.close,confirmLoading:r,children:a(b,{form:t,children:p($,{children:[a(h,{span:24,children:a(b.Item,{label:"\u540D\u5B57",field:"name",rules:[{required:!0,message:!0}],labelCol:{span:4},wrapperCol:{span:20},children:a(g,{type:"text"})})}),a(h,{span:24,children:a(b.Item,{label:"\u7F16\u53F7",field:"code",rules:[{required:!0,message:!0}],labelCol:{span:4},wrapperCol:{span:20},children:a(g,{type:"text"})})}),a(h,{span:24,children:a(b.Item,{label:"\u6392\u5E8F",field:"sortIndex",labelCol:{span:4},wrapperCol:{span:20},children:a(j,{})})})]})})})}function J(){const e=C.exports.useRef(),[t,r]=x({visible:!1,close:()=>{r(u=>{u.visible=!1})}}),[l,s]=C.exports.useState(),[d]=x({reqDel:N});function c(u){const i=new Map,n=[];return u.forEach(f=>i.set(f.id,{...f,children:[]})),u.forEach(f=>{const y=i.get(f.pid);y?y.children.push(i.get(f.id)):n.push(i.get(f.id))}),n}const o=[{title:"\u540D\u5B57",dataIndex:"name"},{title:"\u64CD\u4F5C",key:"option",render:(u,i)=>p(R,{children:[p(v,{type:"text",onClick:()=>{r(n=>{n.id=i.id,n.level=i.level,n.uuid=void 0,n.visible=!0}),s(void 0)},children:[a(H,{}),"\u521B\u5EFA"]}),p(v,{type:"text",onClick:()=>{r(n=>{n.id=void 0,n.level=void 0,n.uuid=i.uuid,n.visible=!0}),s({name:i.name,code:i.code,sortIndex:i.sort_index})},children:[a(S,{}),"\u4FEE\u6539"]}),a(V,{reqDel:d.reqDel,params:{uuid:i.uuid},reload:()=>e.current.reload(),children:p(v,{type:"text",children:[a(G,{}),"\u5220\u9664"]})})]})}];return p(k,{children:[a(z,{data:l,visible:t.visible,id:t.id,level:t.level,uuid:t.uuid,close:t.close,reload:()=>e.current.reload()}),a(q,{ref:e,request:M,dataRender:c,columns:o,pagination:!1,pageSize:!1,toolBarRender:[a(v,{type:"primary",onClick:()=>{r(u=>{u.id=void 0,u.visible=!0,u.uuid=void 0}),s(void 0)},children:"\u521B\u5EFA\u5206\u7C7B"},"create"),a(v,{type:"primary",onClick:()=>e.current.reload(),children:"\u5237\u65B0"},"delete")]})]})}export{J as default};
