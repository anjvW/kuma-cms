import{e as E,r as k,I as h,j as n,_ as y,h as p,B as l,M as d,a as i}from"./index.8f634cb0.js";import{U as C,I as g}from"./index.322aec86.js";import{C as v}from"./index.a5d6483e.js";import{i as w,C as x,D as m}from"./use-immer.module.ed9739a2.js";import{P as O}from"./index.14393530.js";import{d as F}from"./download.9953d649.js";import{I}from"./index.695a4e1e.js";import"./index.60425ddd.js";import"./index.5b4aa7aa.js";import"./index.64808d9c.js";import"./index.e8cd20ff.js";import"./index.0655ebac.js";import"./index.88a8654d.js";function b(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);o&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(e,u).enumerable})),t.push.apply(t,a)}return t}function D(e){for(var o=1;o<arguments.length;o++){var t=arguments[o]!=null?arguments[o]:{};o%2?b(Object(t),!0).forEach(function(a){y(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):b(Object(t)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}function j(e,o){var t=k.exports.useContext(h),a=t.prefixCls,u=a===void 0?"arco":a,r=e.spin,s=e.className,c=D(D({"aria-hidden":!0,focusable:!1,ref:o},e),{},{className:"".concat(s?s+" ":"").concat(u,"-icon ").concat(u,"-icon-download")});return r&&(c.className="".concat(c.className," ").concat(u,"-icon-loading")),delete c.spin,delete c.isIcon,n("svg",{fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48",...c,children:n("path",{d:"m33.072 22.071-9.07 9.071-9.072-9.07M24 5v26m16 4v6H8v-6"})})}var f=E.forwardRef(j);f.defaultProps={isIcon:!0};f.displayName="IconDownload";var B=f;function P(){return p.post("/api/backup/server/backup",{})}function _(){return p.post("/api/backup/server/query",{})}function N(e){return p.post("/api/backup/server/delete",e)}function S(e){return p.post("/api/backup/server/restore",e)}function W(){const e=E.useRef(null),[o,t]=w({backup:!1,upload:!1}),a=async()=>{var u;t(r=>{r.backup=!0});try{const r=await P();r.code===0&&(d.success(r.message),(u=e.current)==null||u.reload())}finally{t(r=>{r.backup=!1})}};return n(v,{children:n(O,{ref:e,toolBarRender:[n(l,{type:"primary",loading:o.backup,onClick:a,children:"\u6570\u636E\u5907\u4EFD"},"backup"),n(C,{action:"/api/backup/server/upload",data:{token:JSON.parse(localStorage.getItem("token")).token},showUploadList:!1,accept:".db",onChange:(u,r)=>{if(r.status==="uploading")t(s=>{s.upload=!0});else if(r.status==="done"){const s=r.response;s.code===0?(d.success(s.message),e.current.reload()):d.error(s.message),t(c=>{c.upload=!1})}},children:n(l,{type:"primary",loading:o.upload,children:"\u4E0A\u4F20\u5907\u4EFD"},"backup")},"upload")],columns:[{title:"\u6587\u4EF6\u540D",dataIndex:"filename"},{title:"\u5907\u4EFD\u65F6\u95F4",dataIndex:"created_at"},{title:"\u6587\u4EF6\u5927\u5C0F",dataIndex:"size",render(u,r){return`${r.size}MB`}},{title:"\u64CD\u4F5C",render(u,r){return i(x,{children:[i(l,{type:"text",onClick:()=>{F("/api/backup/server/download",{filename:r.filename})},children:[n(B,{}),"\u4E0B\u8F7D\u5907\u4EFD"]}),n(m,{reqDel:S,params:{filename:r.filename},reload:()=>{e.current.reload()},title:"\u786E\u8BA4\u4ECE\u670D\u52A1\u5668\u6570\u636E\u5E93\u5907\u4EFD\u6062\u590D\u6570\u636E\u5E93?",content:"\u6062\u590D\u540E\u5C06\u4F1A\u8986\u76D6\u5F53\u524D\u6570\u636E\u5E93",children:i(l,{type:"text",children:[n(g,{}),"\u6062\u590D\u6570\u636E\u5E93"]})}),n(m,{reqDel:N,params:{filename:r.filename},reload:()=>{e.current.reload()},children:i(l,{type:"text",children:[n(I,{}),"\u5220\u9664\u5907\u4EFD"]})})]})}}],request:_})})}export{W as default};
