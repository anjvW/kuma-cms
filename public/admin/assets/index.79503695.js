import{e as O,r as h,a7 as B,j as r,a8 as w,am as b,aB as F,a as v,a6 as g,aF as j,ao as E,ap as P,B as p,aG as S}from"./index.c441dd43.js";import{C as k}from"./index.47555718.js";import{P as q}from"./index.472e9e23.js";import{r as _,j as A,i as x,c as M,k as N,C as R,D as G,I as V}from"./DelPopconfirm.78582ff9.js";function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),a.push.apply(a,i)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?D(Object(a),!0).forEach(function(i){w(e,i,a[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(a,i))})}return e}function L(e,t){var a=h.exports.useContext(B),i=a.prefixCls,s=i===void 0?"arco":i,d=e.spin,c=e.className,o=I(I({"aria-hidden":!0,focusable:!1,ref:t},e),{},{className:"".concat(c?c+" ":"").concat(s,"-icon ").concat(s,"-icon-subscribe-add")});return d&&(o.className="".concat(o.className," ").concat(s,"-icon-loading")),delete o.spin,delete o.isIcon,r("svg",{fill:"none",stroke:"currentColor",strokeWidth:"4",viewBox:"0 0 48 48",...o,children:r("path",{d:"M24.53 6.007H9.97c-.535 0-.97.449-.97 1.003V41.8c0 .148.152.245.28.179l15.25-7.881 14.248 7.88c.129.067.28-.03.28-.179V22.06M27.413 11.023h6.794m0 0H41m-6.794 0V4m0 7.023v7.023"})})}var y=O.forwardRef(L);y.defaultProps={isIcon:!0};y.displayName="IconSubscribeAdd";var H=y;const{Row:$,Col:m}=E;function z(e){const[t]=b.useForm(),[a,i]=h.exports.useState(!1);h.exports.useEffect(()=>{e.data&&t.setFieldsValue(e.data),e.visible||t.resetFields()},[t,e.data,e.visible]);async function s(){t.validate().then(async d=>{var o;i(!0);let c;e.uuid?c=await _({...d,uuid:e.uuid}):c=await A({...d,pid:(o=e.id)!=null?o:0,level:e.level?e.level+1:1}),c.code===0&&(P.success(c.message),e.reload(),e.close(),t.resetFields())}).catch(d=>{console.log(d)}).finally(()=>{i(!1)})}return r(F,{width:800,title:e.uuid?"\u66F4\u65B0\u5206\u7C7B":"\u521B\u5EFA\u5206\u7C7B",visible:e.visible,onOk:s,onCancel:e.close,confirmLoading:a,children:r(b,{form:t,children:v($,{children:[r(m,{span:12,children:r(b.Item,{label:"\u540D\u5B57",field:"name",rules:[{required:!0,message:!0}],children:r(g,{type:"text"})})}),r(m,{span:12,children:r(b.Item,{label:"\u7F16\u53F7",field:"code",rules:[{required:!0,message:!0}],children:r(g,{type:"text"})})}),r(m,{span:12,children:r(b.Item,{label:"\u6392\u5E8F",field:"sortIndex",children:r(j,{})})})]})})})}function J(){const e=h.exports.useRef(),[t,a]=x({visible:!1,close:()=>{a(u=>{u.visible=!1})}}),[i,s]=h.exports.useState(),[d]=x({reqDel:N});function c(u){const n=new Map,l=[];return u.forEach(f=>n.set(f.id,{...f,children:[]})),u.forEach(f=>{const C=n.get(f.pid);C?C.children.push(n.get(f.id)):l.push(n.get(f.id))}),l}const o=[{title:"\u540D\u5B57",dataIndex:"name"},{title:"\u64CD\u4F5C",key:"option",render:(u,n)=>v(R,{children:[v(p,{type:"text",onClick:()=>{a(l=>{l.id=n.id,l.level=n.level,l.uuid=void 0,l.visible=!0}),s(void 0)},children:[r(H,{}),"\u521B\u5EFA"]}),v(p,{type:"text",onClick:()=>{a(l=>{l.id=void 0,l.level=void 0,l.uuid=n.uuid,l.visible=!0}),s({name:n.name,code:n.code,sortIndex:n.sort_index})},children:[r(S,{}),"\u4FEE\u6539"]}),r(G,{reqDel:d.reqDel,params:{uuid:n.uuid},reload:()=>e.current.reload(),children:v(p,{type:"text",children:[r(V,{}),"\u5220\u9664"]})})]})}];return v(k,{children:[r(z,{data:i,visible:t.visible,id:t.id,level:t.level,uuid:t.uuid,close:t.close,reload:()=>e.current.reload()}),r(q,{ref:e,request:M,dataRender:c,columns:o,pagination:!1,pageSize:!1,toolBarRender:[r(p,{type:"primary",onClick:()=>{a(u=>{u.id=void 0,u.visible=!0,u.uuid=void 0}),s(void 0)},children:"\u521B\u5EFA\u5206\u7C7B"},"create"),r(p,{type:"primary",onClick:()=>e.current.reload(),children:"\u5237\u65B0"},"delete")]})]})}export{J as default};
