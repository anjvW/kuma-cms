import{h as p,ae as s,au as r,r as m,j as e,H as v,B as c,a as d,bf as g,bg as F,F as O}from"./index.bbf9ba40.js";import{C as b}from"./index.91f458ea.js";import{P as A}from"./index.067b7790.js";import{i as k,C as P,D as S}from"./use-immer.module.f5029fbd.js";import{S as w}from"./index.5c4aacb0.js";import"./index.ab3d9ecf.js";import{c as T}from"./convertNullToUndefined.a19d8223.js";import{I as j}from"./index.b563d437.js";import{I as q}from"./index.93bb3af8.js";import"./index.cb0f6253.js";import"./index.8a46b0ef.js";import"./index.92107fe3.js";function L(t){return p.post("/api/message/query",t)}function V(t){return p.post("/api/message/detail",t)}function H(t){return p.post("/api/message/delete",t)}function R(){return p.post("/api/message/status")}const z=s.TextArea;function M(t){const[u]=r.useForm();return m.exports.useEffect(()=>{if(t.data){const n=T(t.data);u.setFieldsValue({...n})}},[t.data]),m.exports.useEffect(()=>{t.visible===!1&&u.resetFields()},[u,t.visible]),e(b,{title:"\u6D88\u606F\u8BE6\u60C5",extra:e(v,{style:{cursor:"point",color:"#333",fontSize:"16px"},onClick:()=>t.close()}),actions:[e(c,{type:"default",onClick:()=>t.close(),children:"\u5173\u95ED"},"cancel")],children:d(r,{form:u,labelCol:{span:2},wrapperCol:{span:8},children:[e(r.Item,{label:"\u540D\u5B57",field:"name",children:e(s,{readOnly:!0})}),e(r.Item,{label:"\u624B\u673A",field:"phone",children:e(s,{readOnly:!0})}),e(r.Item,{label:"\u90AE\u7BB1",field:"email",children:e(s,{readOnly:!0})}),e(r.Item,{label:"\u6765\u6E90",field:"source",children:e(s,{readOnly:!0})}),e(r.Item,{label:"\u72B6\u6001",field:"status",children:e(w,{options:t.status,disabled:!0})}),e(r.Item,{label:"\u4F01\u4E1A",field:"company",children:e(s,{readOnly:!0})}),e(r.Item,{label:"\u4E3B\u9898",field:"subject",children:e(s,{readOnly:!0})}),e(r.Item,{label:"\u5185\u5BB9",field:"content",wrapperCol:{span:22},children:e(z,{autoSize:!0,style:{minHeight:64},readOnly:!0})})]})})}function ee(){const t=g(),u=F(),n=new URLSearchParams(u.search),B=n.get("name"),x=n.get("phone"),C=n.get("email"),f=m.exports.useRef(),[o,y]=k({visible:!1,close:function(){y(l=>{l.visible=!1})}}),[h,I]=m.exports.useState([]);async function E(l){try{const a=await V({uuid:l});a.code===0&&y(i=>{i.data=a.data,i.visible=!0})}catch{}}m.exports.useEffect(()=>{R().then(l=>{const a=[];for(const i in l.data)l.data[i]!==""&&a.push({label:l.data[i],value:i});I(a)})},[]);const D=[{title:"\u540D\u5B57",dataIndex:"name",ellipsis:!0,search:!0,initialValue:B,fieldProps:{readOnly:!0}},{title:"\u624B\u673A",dataIndex:"phone",search:!0,initialValue:x,fieldProps:{readOnly:!0}},{title:"\u90AE\u7BB1",dataIndex:"email",search:!0,initialValue:C,fieldProps:{readOnly:!0}},{title:"\u4F01\u4E1A",dataIndex:"company"},{title:"\u6765\u6E90",dataIndex:"source"},{title:"\u72B6\u6001",dataIndex:"status",render(l,a){return h.find(i=>i.value===a.status).label},search:!0,valueType:"select",fieldProps:{options:h}},{title:"\u5173\u952E\u8BCD",dataIndex:"keyword",search:!0,hide:!0},{title:"\u64CD\u4F5C",width:280,render:(l,a)=>d(P,{children:[d(c,{type:"text",onClick:()=>E(a.uuid),children:[e(j,{}),"\u8BE6\u60C5"]}),e(S,{reqDel:H,params:{uuid:a.uuid},reload:()=>f.current.reload(),children:d(c,{type:"text",children:[e(q,{}),"\u5220\u9664"]})})]})}];return d(O,{children:[o.visible&&e(M,{visible:o.visible,data:o.data,close:()=>o.close(),reload:()=>f.current.reload(),status:h}),e(b,{style:{display:o.visible?"none":void 0},children:e(A,{ref:f,request:L,columns:D,immediateSearch:!0,actionBarRender:[e(c,{type:"primary",onClick:()=>t.goBack(),children:"\u8FD4\u56DE\u7EBF\u7D22\u7BA1\u7406"},"refresh"),e(c,{type:"primary",onClick:()=>f.current.reload(),children:"\u5237\u65B0"},"refresh")]})})]})}export{ee as default};
