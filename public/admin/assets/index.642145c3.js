import{h as c,au as d,at as l,r as p,j as t,H as F,B as o,a as s,ba as C,F as B,bb as x}from"./index.17afa57a.js";import{U as _}from"./index.1c80a89c.js";import{C as h}from"./index.78af0889.js";import{D as b,P as I}from"./index.b31c21f2.js";import{i as y,C as E,D as v}from"./use-immer.module.275c8cce.js";import"./index.10dfb9a6.js";import{I as w}from"./image.0c93b1fb.js";import{I as A}from"./index.e9f70ed9.js";import"./index.7f0e34d3.js";import"./index.7ec2cf08.js";import"./index.ba74eecf.js";import"./index.70b46f9a.js";import"./index.2739d5bf.js";function D(i){return c.post("/api/team/query",i)}function L(i){return c.post("/api/team/detail",i)}function k(i){return c.post("/api/team/create",i)}function j(i){return c.post("/api/team/update",i)}function q(i){return c.post("/api/team/delete",i)}const S=d.TextArea;function z(i){const[u]=l.useForm(),[n,m]=p.exports.useState(!1);async function f(){u.validate().then(async e=>{m(!0);try{const a={...e,profile_image:e.profile_image&&e.profile_image.length!==0?e.profile_image[0].response.data.name:void 0,detail_images:e.detail_images&&e.detail_images.length!==0?JSON.stringify(e.detail_images.map(g=>g.response.data.name)):void 0,status:e.status?"true":"false",sort_index:e.sortIndex===0?void 0:e.sortIndex};let r;i.data?r=await j({...a,uuid:i.data.uuid}):r=await k(a),r.code===0&&(i.reload(),i.close())}finally{m(!1)}}).catch(()=>{console.error("\u4FE1\u606F\u4E0D\u5B8C\u6574")})}return p.exports.useEffect(()=>{if(i.data){const e=i.data,a=e.profile_image;u.setFieldsValue({...e,profile_image:e.profile_image?[{uid:e.profile_image,url:a,response:{data:{name:e.profile_image.replace("/media/image?n=",""),path:e.profile_image}}}]:[],sort_index:e.sort_index?e.sort_index:void 0})}},[i.data]),p.exports.useEffect(()=>{i.visible===!1&&u.resetFields()},[u,i.visible]),t(h,{title:i.data?"\u4FEE\u6539\u6210\u5458":"\u521B\u5EFA\u6210\u5458",extra:t(F,{style:{cursor:"point",color:"#333",fontSize:"16px"},onClick:()=>i.close()}),actions:[t(o,{type:"default",onClick:()=>i.close(),children:"\u53D6\u6D88"},"cancel"),t(o,{type:"primary",loading:n,onClick:f,children:i.data?"\u4FDD\u5B58":"\u521B\u5EFA"},"submit")],children:s(l,{form:u,labelCol:{span:2},wrapperCol:{span:22},children:[t(l.Item,{label:"\u6210\u5458\u540D\u5B57",field:"name",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6210\u5458\u540D\u5B57"}],children:t(d,{maxLength:100,showWordLimit:!0,placeholder:"\u8BF7\u8F93\u5165\u6210\u5458\u540D\u5B57"})}),t(l.Item,{label:"\u6210\u5458\u804C\u4F4D",field:"job_title",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6210\u5458\u804C\u4F4D"}],children:t(d,{maxLength:100,showWordLimit:!0,placeholder:"\u8BF7\u8F93\u5165\u6210\u5458\u804C\u4F4D"})}),t(l.Item,{label:"\u6210\u5458\u5934\u50CF",field:"profile_image",triggerPropName:"fileList",children:t(_,{action:"/api/upload/image",data:{token:JSON.parse(localStorage.getItem("token")).token},imagePreview:!0,accept:"image/png, image/jpg, image/jpeg",listType:"picture-card",limit:1})}),t(l.Item,{label:"\u6210\u5458\u7B80\u4ECB",field:"introduction",children:t(S,{maxLength:200,placeholder:"\u6210\u5458\u7B80\u4ECB",showWordLimit:!0,autoSize:!0,style:{minHeight:64}})}),t(l.Item,{label:"\u6210\u5458\u624B\u673A\u53F7",field:"phone",children:t(d,{maxLength:100,showWordLimit:!0,placeholder:"\u6210\u5458\u624B\u673A\u53F7"})}),t(l.Item,{label:"\u6210\u5458\u90AE\u7BB1",field:"email",rules:[{validator(e,a){e&&!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e)&&a("\u90AE\u7BB1\u683C\u5F0F\u4E0D\u6B63\u786E")}}],children:t(d,{maxLength:100,showWordLimit:!0,placeholder:"\u6210\u5458\u90AE\u7BB1"})}),t(l.Item,{label:"\u5165\u804C\u65F6\u95F4",field:"joined_date",wrapperCol:{span:3},children:t(b,{style:{width:200}})}),t(l.Item,{label:"\u6392\u5E8F",field:"sort_index",wrapperCol:{span:3},children:t(C,{maxLength:10,hideControl:!0,precision:0,placeholder:"\u6392\u5E8F"})})]})})}function K(){const i=p.exports.useRef(),[u,n]=y({visible:!1,close:function(){n(e=>{e.visible=!1})}});async function m(e){try{const a=await L({uuid:e});a.code===0&&n(r=>{r.data=a.data,r.visible=!0})}catch{}}const f=[{title:"\u5173\u952E\u8BCD",dataIndex:"keyword",search:!0,hide:!0},{title:"\u540D\u5B57",dataIndex:"name",ellipsis:!0},{title:"\u5934\u50CF",width:150,dataIndex:"profile_image",render:(e,a)=>{if(a.profile_image){let r="";return r=a.profile_image,t(w,{width:40,height:40,src:r})}else return"\u6682\u65E0\u5C01\u9762"}},{title:"\u804C\u4F4D",dataIndex:"job_title"},{title:"\u4ECB\u7ECD",dataIndex:"introduction",ellipsis:!0},{title:"\u90AE\u7BB1",dataIndex:"email",ellipsis:!0},{title:"\u624B\u673A\u53F7",dataIndex:"phone"},{title:"\u5165\u804C\u65F6\u95F4",dataIndex:"joined_date"},{title:"\u64CD\u4F5C",width:280,render:(e,a)=>s(E,{children:[s(o,{type:"text",onClick:()=>m(a.uuid),children:[t(x,{}),"\u7F16\u8F91"]}),t(v,{reqDel:q,params:{uuid:a.uuid},reload:()=>i.current.reload(),children:s(o,{type:"text",children:[t(A,{}),"\u5220\u9664"]})})]})}];return s(B,{children:[u.visible&&t(z,{visible:u.visible,data:u.data,close:()=>u.close(),reload:()=>i.current.reload()}),t(h,{style:{display:u.visible?"none":void 0},children:t(I,{ref:i,request:D,columns:f,actionBarRender:[t(o,{type:"primary",onClick:()=>i.current.reload(),children:"\u5237\u65B0"},"refresh")],toolBarRender:[t(o,{type:"primary",onClick:()=>{n(e=>{e.visible=!0,e.data=void 0})},children:"\u521B\u5EFA\u6210\u5458"},"create")]})})]})}export{K as default};
